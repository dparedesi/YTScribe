---
video_id: E_xm8W_BEFk
video_url: https://www.youtube.com/watch?v=E_xm8W_BEFk
is_generated: False
is_translatable: True
---

Hi. Welcome. Uh, welcome to Reinvent 2025. Uh, I, I hope you have enjoyed your first day and hopefully you'll enjoy the rest of the week. My name is Tuit Amman. I'm a solutions architect specialist for Ed services at AWS. It's a mouthful, I know. Uh, and with me is Dana Vidan from HSBC. He'll introduce himself, uh, a bit later into the, into the presentation. Today we're gonna cover it's a level 300 talk, uh, a typical or maybe not so typical day in a WAF administrator life. It will be a bit hectic. Uh, it will be a bit technical. The fact that it's a level 300 talk means that we assume that you know some things about anybody else who have already, so, uh, we won't dive into the what are rules or what are actions. We'll, we'll dive a bit into labels and, and maybe a bit more of the new stuff, but we assume some level, some technical level, uh, from the get-go. Apologies for the pace. I, I, I talk fast, naturally, and we have a lot to pack into 60 minutes, so I'll be even faster. You can watch it later on YouTube at like 70.75 and it will make more sense, but for now, it's gonna be rushed. Uh, we'll have this talk built in a way of a story. Uh, I'll, I'll, I'll make believe as if I'm a WF administrator, and I'll take, take you through one of my days, but later we'll have an actual story by Dan at HSBC, uh, who'll discuss the way they journeyed through adopting AWSWF. So with that, we'll start waking up. It's morning, a new day, a new web application. So I just got a a a notification in the morning on the way to work that there's a new application out there. Um, my company probably misunderstood the hype with bots, uh, and AI bots, and they built an actual bot robot selling website and mobile app. So there's this new application, uh, that now I, as the web administrator, need to go out and protect. Initially this is the architecture, so it's built. To serve web users, mobile applications, sending typically API calls, as well as, well, unknown automated clients such as good bots and bad bots, so it's just out there and everybody can use it. It will initially hit Cloudfront, our CDN service, as the ingress point, and from there, Cloudfront will route the traffic into multiple back-end components or really front-end components at the back of Cloudfront. We'll have uh an ALB act as the load balancer for the web components. We'll have an API gateway that will route API calls to different lambda workers, uh, and lambda integrations, and we'll have a static content. It's a single page application eventually, so the HTMLs and the CSS files and JavaScript files all hosted on an S3 bucket, and, and Cloud Front will take care of all that now. This is my headache. Like I got my morning coffee. And now I need to decide. How I do it? How do I protect this, uh, uh, newly birthed application? So there are multiple questions we need to ask ourselves when we decide how to protect a specific application. We need to ask ourselves where. So where do we protect it? We saw multiple components. Where do we put WAF? Do we put it, uh, at the very edge on the cloud front? Do we have separate WAFs on the API gateway, uh, and on the ALB? Where should we put it? And it really depends. It depends on who's gonna manage it and how much time do they have. If we wanna spend time and really tune each and every policy for the different components of the application, probably it will make sense to have different web application firewall policies on top of the ALB and the API gateway, but we don't have that much time to manage all of these applications separately. And more, most importantly, we would want to block attacks as they come in at the very edge of the network. So we will look into the different places we can put we probably will enable it on cloud front. Then when, when do we need this application protected? If we have time, we can plan ahead and start things in staging and test it out and tune it and then when we're, we're, uh, when we're ready to launch into production, we can start turning on the different rules, but I got this call this morning and the when is now, so the application is already out there. I have to protect it. So in this case, typically we have to make some compromises we never have. All the time in the world, so typically there is some, some urgency when we deploy WAF, so we'll need to make some compromises, at least initially. We'll need to decide that some things will go on immediately in blocking modes, other things will go on in count mode so we can tune them as traffic starts to flow through the application, but again. This remains to be seen. We need to turn it on and see what happens. Another question is who? So who's gonna manage this web application firewall policy? Is it me, the security guy? Is it the application people? Each application component has its own WAF policy, and that means that each of these people need to manage their own WAF. This really changes the complexity that I can, uh, basically put on them. So if they need to manage something they don't know really well. They would typically do simple things. On the other hand, if the application people are managing the web application firewall policy, they really know when they introduce new changes to the application, and they really know what those changes are, so they can tune the web application firewall policy according to those application changes. So again, We need to balance things out. We need to understand and decide what goes where and who manages what. And finally, the what? So. A WAF policy is a complex thing. It can do many different things. Obviously we can go and turn on all of the different toggles. Probably it will be a mess. Um, probably some things will get blocked that weren't meant to be blocked, and we'll have to roll back and do something else. So the what is, what are we putting in place day one and what are we planning to put in place day 100. And how do we plan to roll that out? So, what will my policy contain? So we don't have time for everything today, so we'll focus on these two questions on the where and on the what for this talk. As for the aware One thing we can do, and that's typically the best option, is to put a policy on top of cloud font. Why? Well, initially we want to block traffic at the very edge, especially if we're talking about volumetric attacks. We do not want them to reach all the way into our origins, into our VPC. There are multiple reasons for why we don't want to do that, but remember that with Cloudfront we have 750+ points of presence, all of them are hundreds of gigabytes, gigabit per second capacity, so. It's a very well built mechanism built and designed to withstand these peaks in traffic, so blocking bad traffic at that point makes a lot of sense, right? On the other hand, we might also want to consider building web application firewall policies, smaller ones, more granular ones, and put them in place on top of the different application components and maybe let the application people handle them. So some designs we see that we have a coarse grain control at the very front, on top of the cloud front. With finer grain controls with smaller weft policies running on top of the underlying services, ALB API gateway, A Runner, whatever. At the very least, we do wanna see we running on cloud front. That would be the best place to start blocking incoming attacks. Once we have put Cloudfront on top of the application, there is one consideration we have to think of, and that is how do we make sure that no one bypasses our WAF. And for that we, we have to utilize mechanisms known as origin cloaking or origin masquerading. Basically we want to make sure that only traffic that originated from WAF can hit our origins, be it an S3 bucket or an API gateway or an ALB. So when it comes to uh protecting the most common use case where where we have a VPC based application and we need to make sure that only traffic coming from from uh uh cloud front with WAF can hit it, the best course of action would be to enable VPC origins. It's a kind of a new feature we have it for a few months, so I don't know how many of you already use it and know it. But it's the best way to protect your origins basically by enabling VPC origins, we turn the load balancer to become an internal resource. They no longer have uh public IP addresses. They no longer have, uh, uh, they're no longer accessible from the internet. The only thing that can contact these load balancers is the specific platform distribution that we assigned to it, so it's not even. All of Cloudfront is a very specific cloud front distribution and that's called VPC origin. That, that's the best case scenario. In case we have. An S3 bucket, the best way to protect that bucket without making uh making it public is to enable origin access Control or OAC on it. Basically that means that whenever Cloudfront communicates to that bucket, it uses IM policies. It assumes a role really. To to get access to that bucket just like any other thing, uh, any other policy that you would put on a bucket, the S3 bucket will now have the cloud front row assigned and allowed to fetch the objects from the bucket, right? So these two, solutions will allow you to cloak and to mask and to protect your resources, basically forcing traffic to go through cloud front, and there is no other way in. In case you don't have one of these components in the application, maybe you're running an on-prem application, maybe your application is running on another cloud, like that we'll discuss later. There are still other ways you can utilize to make sure that no one can contact your your your origin without going through Cloudfront. Basically would then you would want to limit access at the IP level with our managed and unmanaged prefix lists. So there's a JSON file out there on the web as well as a managed prefix list on every VPC that you can use in your security groups to make sure that only cloud front incoming IP addresses are allowed in, but that's not good enough because any cloud front distribution can access the application. And for that reason, we typically want to add, to add into your classroom dis uh distribution configuration, a secret header. Preferably something that rotates every once in a while, and that secret header is being being added into every single request going out of Cloudfront towards the origin, and it needs to be enforced at the origin, maybe with an ALB rule, maybe with an Engine X rule, but someone needs to look at the incoming headers and make sure that only requests coming with that secret header are being allowed through. So that's, that's just a side discussion. In order to keep a stable and and best practice kind of application architecture. Let's move on to the what. So, what is a big topic? How to start building an AWSWAF policy used to be one of my biggest conversation topics with customers, and I've been dealing with with customers about WAF for too many years that I would like to admit, uh, but starting kind of recently, it became super easy. So one easy way. To enable a WAF policy on top of your cloud front is to go into the into the cloud front uh console, and I don't know how many of you saw that this is kind of new. We've had it out for about 2 weeks. Uh, just pick a flat rate pricing plan that includes WAF in it, and it will already include components of WAF for you. So if we, if we zoom in for a second, we'll see the different plans. Coming all the way from 0 for a very simple configuration still including Cloudfont, including DNS including a simple WAF configuration um. All the way to the different pricing plans and by choosing one of these plans, you basically get a pre-made policy which is typically good enough. Now these are big words, typically good enough. It's way better than nothing, and it's a very good start to allow you to start massaging your rules into the policy. It will allow you to start where it's safe and manageable and work your way up and and we'll we'll we'll talk about manageability and security. The security balance, uh, a bit later, zooming into the business offering in the middle there, just to see what everything that it includes, I'm just hijacking the discussion for a second for marketing. Uh, it does include quite a bit. So it includes the DS protection. It includes storage in S3. It, it includes DNS requests. It's, it's a really nice, nice package, and you can have multiples of these in your different distributions. So let's say you have 50 distributions, each of them can have one of these packages attached. Uh, so, in, in case you're dealing with an application that you know nothing about or you yourself don't know enough to start out with a solid web configuration, that would be a very good way to start from the cloud front console. Once you start configuring or enabling WAF on cloud front, there are very simple questions you can uh you can answer by ticking a box. Do you want SQL protection? Do you want rate limiting rules? Do you want to run in count mode or monitor mode only? Very simple toggles. You don't even have to know WA you or the application owners that you delegate to, they don't have to know really anything about WAF. It's good enough to start with. Again, good enough to start with. You can definitely. And probably uh it, it will be best if you build on top of this and add more controls as you go forward. So this is all the console of AWS uh sorry, uh Amazon Cloudfront, really easy to begin uh building WAF on top of that. When you start from the WAF console, the experience is a bit, is a bit different. So again, this is a change we've committed not too many months ago, so I don't know how many of you are familiar with it. Basically, when you create a new web ACL or protection pack as we call them now, uh, you're being asked simple questions about the application. What kind of an application is it? Is it content, uh, content delivery? Is it an API? Is it a mix of them? Is it retail? And you just uh check a box. And you start building your application configuration from there without knowing anything about that. Just basically answering questions about your application, which should, which you should know, you or the application owner. Going from there, you can pick one of these pre-made packages, pre-made protection packs that include a good enough security policy. It contains a bit more than the uh cloud front deployed policy does, uh, assuming that if you are already on the WAF console, you probably know a bit more and you'll be allowed into more of the secret sauce. Uh, so again, three options a basic one, basically rate limiting, uh, uh. IP reputation services enabled. Bot control in count mode, common bot control. You can move on to the essential pack. And you can have more, so more is not necessarily always better, right? We obviously want to strive to a very robust feature rich policy that protects you against different kinds of things that's happening in the Internet, but. It, it may incur some costs on you, operational costs, and typically when we start too strong with WAF, and I've seen it happen multiple times, not with AS WAF necessarily, but all WAFs, when you start, when you come on too strong with WAF, at the first sign of trouble, like you're getting false positives, you're getting blocked requests, there's too much to handle and you just switch it off. And the, the hurdle you have to jump through in order to re-enabling it after getting burned is super high. So I would suggest starting low and building on top of that on what you already have and you already have uh uh established trust with you know how the mechanism works, you know where the logs are, you know how to tune things, you can start building from that. Once you configure the application policy through WAF, there are a few other things you can configure, such as what are the rate limit thresholds. So it could be anything that fits your application. I think we start here with 1000 requests per IP per minute or per 5 minutes, sorry, but you can tune that into something as low as 10 requests if that's what your application needs, or as high as 2 billion requests if that's what your application needs. So we start out with a good normal number, but you can tune that. And this part here is super simple but super important to enable, and that's logging. So you just have to say I want logging, basically ticking a box, and the same goes by uh by the way, on the cloud front console, super easy to enable web logging, and it sends logging towards cloudWatch logs. Now, going back to the uh fixed pricing plan that we announced a few weeks ago. Logs are included in that pricing plan, so it's no longer a concern. Cloudwatch logs, which are the easiest way to manage WAF logs, are included in the pricing plan, so you can just go ahead, check the box, and enable that. Even without that. Without the pricing plan on the good old pay as you go model, we've decreased the price of cloudWatch logs with WAF. We now provide 500 megabytes of free logs per every million WAF requests that you send through, so it really reduces, helps reduce the cost in case you don't go with the protection plan, with the pricing plan, sorry. So summarizing, we know what we know the what we know we're going for the essential pack, we know what we're getting, we're getting some IP based blocks, we're getting geolocation-based blocks, we're getting some very good core HTTP compliance protection rules. We're getting what we call known bad inputs or known vulnerabilities like log 4J all with a simple click. We're even getting the new layer 7 DDoS rule. In count mode, so it's already enabled. It's in the right place in the policy at the very top. And all that remains to us is just monitor what it does and enable it when we're ready. Time for a well earned coffee. So I got there in the morning. I got the news of the new application. I built with a few clicks, uh, the, the WAF policy that fits my needs. Now it's time to look at the logs. This, this is what makes me feel good looking at dashboards all day. I really like that. So I don't know how similar you think this guy is to me. I tried. I even wearing, I'm even wearing the same kind of shirt. Uh, imagine that that is me. That's the best I could do with AI. I'm a waf guy, not an AI guy. So, uh, out of the box with AWS WAF you have these built-in dashboards. Again, it used to be a pain to, to spin up dashboards in WAF, uh, or I would say a relative pain. Where you have to know what you're doing and what kind of queries you need to run to build the cloudWatch dashboard widget. Uh, now, starting June, last June, uh, we launched this new UI with this, this super useful. Dashboard widgets that really allow you to see where traffic is coming from, which rules are being hit, uh, what kind of bot traffic you're seeing, what kind of Dios traffic you're seeing, really, really dive into the different insights, top IP addresses, top URIs, top user agents, top fingerprints, 34 fingerprints, all useful stuff enabled by default. And the most important thing, you can start navigating. The logs directly. From the console, so no need to run this. Tiring. Uh, cloud watch log, uh, queries, it's all built in. You can click an IP address on the top IP list and filter by that IP and start seeing what these IPs are doing in your application. Each of these lines is, uh, uh, basically clickable. You can see the full request details, the IP address, the reputation, the query string parameters, the labels that we accumulated. Uh, for that specific request, and everything is actionable, so you can take anything out of it, put it back in the filter, show me more requests with this URL, show me more requests with this fingerprint. And you can still use the good old cloudWatch log insight queries if you need to build something more comprehensive, like more advanced querying. Obviously this is all true if you're using CloudWatch logs, but it does make sense because it's cheaper, it's included in the pricing plan. But if you're using other destinations for logging, we'll talk about that. You can use the same kind of schemes to build your own dashboards, run Athena queries on top of S3, and so on, like, like we, like you used to. We didn't change, we didn't change that. OK, looking at the logs, I feel relaxed. I had my coffee. It's time for the lunch break and you know what, let's put the break in lunch break. So, just sitting down to have my lunch, we're starting, I start to hear yells from upstairs in marketing. They say something about 403 customers complaining, probably something they misheard, um, so I, I, I start looking at the dashboard and I see these 403s. I see. Multiple blocks coming from different IP addresses, all with the cross-ite scripting in body rule being hit. So I, I, I have a sneaking suspicion it's gonna be a false positive that I have to mitigate. So, I start diving into the, into the logs more. I see different IP addresses. I, I look at these IP addresses and I see that they're basically benign. They're doing good things. They're logging in, they're purchasing bots, they're posting on the forum. Uh, but they're also triggering this one rule on a very specific web page, uh, where we are detecting a cross-site scripting attempt in the body. I'm assuming this is a false positive. We have to deal with it. So, first rule in dealing with false positives is stay calm. Don't turn off laugh, don't roll back the change. Try and understand exactly what is the pattern that triggers the false positive. Once you do that It could be a a a specific URI, it could be a specific uh parameter, it could be anything really in the request that by looking and navigating through the dashboard, you really can pinpoint and you start building a rule around that. So you see, now I'm calm. Again, I think this guy looks like me. uh, so first we go and switch off the rule that triggered the false positive. In our case it was a cross site scripting attempt in the request body, so we go and turn that off or switch it to count. Right, so now no more users are getting blocked, but then again we're not enforcing cross-site stripping in body anymore, which is not a good thing. So we are building a different rule right after the rule admitted that uh triggered the, the, uh, the false positive. And that rule is built in a way that says still block cross-site scripting attacks based on this label, and we'll talk about the label in a second. Still mitigate cross-site scripting attacks, but don't do it if the URI is slash missing robots form. Because that was the one that I saw in my logs. So by that I basically turned cross-site scripting in body back on, back into being, being enforced, but I exempted the uh the specific URI from that rule. All other attacks on that URI are are still valid, so this is a very good fine-grained way to mitigate false positives. So, once we do that, we start tuning. So tuning helps us avoid chaos. So tune your policy often, tune it early, don't wait for something to happen. So review the logs, make sure that uh you're doing the right things, enough traffic is being blocked, enough blocked, enough traffic is being let through. Uh, when you do make changes, make changes gradually. Don't add five different rules on the same day. So again, too much is not better, uh, necessarily with WA. So add rule gradually, monitor effect. And manage your traffic with labels. So there's a little starter with labels. I don't know how many of you know labels, but labels are my and your best friend when it comes to WAF. So a bit about labels. Labels are metadata that we add into every single request that goes through WAF. We can add them with managed rules by default, all managed rules add different labels. For example, these are the labels being emitted by the core rule set. A part of them, there are more. We can add labels on our custom rules as part of the action. We can use them as a match or scope down condition on rules. So let's say I want to not inspect uh certain traffic from a certain IP address. I can create a custom rule that adds a label to all traffic from a certain uh from a certain IP address and then use that label to scope down another rule, uh, to not inspect that specific traffic. So we use labels. It will help you uh investigate because labels are visible in your logs. They are visible in cloud watch metrics, and they're also uh usable if you want to filter out certain rules or certain traffic patterns from your logs because they're too, too noisy or cost too much or whatever. So labels super useful tool, uh, they're like the multi-tool of WAF they can really be used to do anything, so add them. Add them always, then think about what to do with them. Labels are your best friends. Then lastly, I know I'm not running late, don't worry, uh, lastly. After, typically I'm from Israel, so typically at 2 p.m. we're having a coffee. I don't know how it is in the US, but at 2 p.m. we're breaking for coffee. Typically it's a strong black coffee. Uh, so, at that time, I would use to optimize my cost. So I tuned my policy. I know that I'm blocking the, the bad stuff. I know that I'm letting through the good stuff. It's already deployed, but now I'm making sure that I'm not making any, any mistakes when it comes to cost. So, uh. In order to control our cost, we initially need to make sure that the right things are getting blocked at the right places with WAF, so making sure that the layer 7 Dios rule is at the very top, because whenever it blocks traffic, it is not incurring any costs. So blocked requests are free in layer 7 DDoS even without a pricing plan. So making sure that this rule is going first, making sure that other page rules such as bot control are scoped down. And only getting traffic which we think they should inspect and also looking at logs, we need to make sure that logs are not being carried over for too long, so setting up a specific log retention period, whatever your business needs, be it 14 days or 7 years, but make sure that you stick to that and don't carry logs forever. Uh, use labels again to filter out noisy logs and again switch to flat rate plans, really predictable, no overages, you know what you're getting every month. When it comes to logs, I really rush, I will really rush through with it because cloudwatch logs are the easiest to configure, typically the cheapest, especially if you have low rates of traffic. When it comes to higher rates, you might want to consider other ways to send out WAF logs. You might want to consider kinesis, data fire hose. Uh, which is outside of the pricing plan, probably the cheapest way for very high volumes of traffic. It can also be used to send traffic to different locations, um, like S3, like an external third party, uh, uh. A vendor like a SAS offering and lastly you can use uh S3 buckets directly to send out WAF logs directly to an S3 bucket. Behind the scenes it does use cloud watch logs, so at high volumes you might incur some some vending costs that you don't expect, but it's the easiest to configure so. Preferably, cloudwatch logs. If not that, Kinesis fire hose. If you need the S3, use the Kinesis fire hose to send traffic or logs towards S3. And finally, if you're using pricing plans, it's really easy to see if you're about to breach the contract that you signed. You can see uh based on what you already had in the month, like how soon will you breach the, the quota that you got, like out of the 500 million requests, how many you already sent, same goal for data transfer, but it's fine though if you're about to breach, as long as it's not a consistent breach, like every month you you're breaching, there will be no overages. If this is happening. More often than not, that you're breaching your quotas, eventually you will experience some throttling. But for that, we have a very clear dashboard in the UI allowing you to keep track of where you're going and is that plan the right plan for you. So this is the end of my coffee break, and I'll hand it over to Dan. Thank you. Hello everyone. Hopefully you're having a great, uh, reinvent, uh, so far. I'm Dana Vidan from HSBC Retail Bank, um, IWPB International Wealth and Premier Banking, and I'm gonna walk you through our, uh, wife journey. So first, in terms of who we are and where we sit within the organization, we're digital enablers, so we provide things like common frameworks and platforms pertaining to mobile authentication and authorization, business process orchestration, and of course what we're going to talk about today, which is our edge routing and protection platform. The services that we provide specifically allow the various value streams to concentrate on their specific business verticals without having to worry about things such as rough protection. So HSBC, one of the biggest banks in the world, we operate in a large number of markets, some of them, and the vast majority of them, for example, can adopt AWS, but there's other ones, for example, where we cannot, so we need to make sure that we operate across multiple cloud providers. So for example, highly regulated markets that have Data residency requirements like China where we cannot use AWS or markets like Egypt for example where we cannot use any cloud providers, we have to make sure that we put our waffles and our protection across the entire. we operate in a highly regulated environment. Every downtime have to be reported to regulators, so protecting the brand, protecting against DDoS attacks is really out of the utmost importance, maybe perhaps a few interesting anecdotes. There's markets, for example, when we own white label brands such as Marks and Spencer money in the UK, in Asia Pacific, for example, we own competing brands that we need to keep separation between them to meet anti-competition laws. So for example, Hang Seng Bank versus Hong Kong. retail bank, we own not only banking but insurance products as well. So all in all, ultimately it creates a fairly diverse traffic pattern to our sites which we obviously need to take account for in our various. We have a regulatory obligation to allow our customers to transact. If people can't access the money. It obviously erodes trust in the financial industry, which regulators feel very strongly about. And of course peak times tend to be challenging times during geopolitical tensions, during natural disasters, which makes it challenging as well. In terms of our team specifically, so as mentioned, we operate in a large number of markets with multiple non-production and production AWS account. We support many value streams. Each one of those value streams have multiple applications. So if you do the math, it ultimately ends up being a huge, huge attack surface, which means the protections really have to be top notch. We get hundreds of terabytes worth of traffic each month, billions upon billions of requests. We have hundreds of cloud from distributions, multiple web icons, and again supporting multiple cloud providers. And unfortunately the reality is that we're literally under daily attacks. It's not something that happens once in a blue moon. It's literally around the clock there's some sort of an attack going on. I'm not going to dwell on this slide too much because it's not those banking challenges are not specific, but it is interesting to know that we're seeing regulators more and more interested in, not so much in the US, but more certainly in Europe from the European Central Bank and in Asia Pacific. is now a mandatory regulatory requirement, so it's quite interesting to see regulators getting involved in mandating the use of. Um, in terms of when the journey started, well, uh, interesting enough, also in reinvent back in 2018, which coincided with the need to create a new, uh, cloud platform. I was personally really inspired with all things serverless, so it was a personal crusade to try and do it completely serverlessly, which we did, and of course the migration to cloud has taken longer than we anticipated. We're still operating in a hybrid cloud environment which requires special considerations. The intention was to specifically shift security left to try and abstract third party service providers in our origins from sensitive security tokens, making sure that we really make sure that they don't have to worry about the edge protection, and this is something that we're providing and again we're doing it all through compute the edge completely surly. So it is the architecture and nothing too exotic, right? So Shield provides the layer 4 mitigation, which passes requests to cloud front and of course inspect the the the request which if not blocked, passes it over to lambda so you can see there's no EC2 reverse boxing. It's all done serverlessly. This predates cloud front function. Ideally now some of these we would migrate to cloud front function. And the other thing to take away that we're not protecting just AWS origin, we created a generic abstracted platform that provides protection to a wide variety of origins, specifically on-prem and even other cloud providers, so for example, some GCP based origins. OK, some challenges. So one, it's an ever evolving threat landscape. Back when we started, DDoS was really not so much of a problem. And if it did, then AWS Shield would mitigate the layer 4 type attacks, and you get to claim credit without really having to do much for it, right? AWS SShield would kick in, mitigate the attack, and, and you're done to layer 7 attacks, right? Uh, malicious, uh, attempts to your domain name slash GTC password, right, hoping to get. Lucky to high volume attacks which we in the industry responded with rate-based tools to then of course to low and slow type attack and of course the concern these days is agentic. So for example, if I have a genuine agent that I really, really want to transfer money on my behalf, how do I distinguish my legitimate agent from a malicious agent? The reality is that unfortunately execs don't really understand the type, even if you're not a tier one bank, the type of thing that your management have probably told you is things like, well, make sure that uh can you confirm that you're getting paged every time we're under attack? No, the team is never going to get any sleep. We're constantly under attack. You want to get paged, for example, when the origin are suffering, when the origins are under duress. Um, there's gonna be a misconception, for example, that you invest in WAF once and it's done, right? So whatever money I invested this year, I don't have to spend it again next year. No, the reality is that you have to continuously invest, you continuously have to uh make sure that you enhance WAF to protect against. New threats, specifically, given the serverless nature of our platform when there were attacks that did breached our perimeters, we got hit, for example, for doing it serverlessly, right, saying, well, if you were to use EC2, you wouldn't have those issues. Why are you using lambda? And the key to take away is that no amount of computing in the world is going to mitigate. A really high volume DDoS attack, right? It's not about the computer to use. The keys to have really strong protection in place to thwart the attacks. It's not about the computer type that you're using. The other reality is that engineers or application teams don't really understand, right? It's not something that unfortunately they deal with on a daily basis, right? They probably understand API gateway really well. Kubernitis, EC2, not really plus they're obviously under pressure to provide new business capabilities. WA is probably not one of them. Cyber, on the other hand, understands security really well but don't really understand the applications and how to protect them, and this is where our team comes in to kind of try and bridge this gap between cyber and the application team. We're in between trying to bridge that gap. Um, from an application perspective, if you're using AWS firewall Manager, organizational policies like you should say OSA 10 type rules, then you have to think how do I integrate application specific or AWS account specific, um. Rules into those policies. Do I do it at build time? Do I do it at run time? There's some consideration there. Um, AWSWAF unfortunately, let's say like AWS Gateway doesn't have deployment stages, so you really have to think about how am I going to roll out my new rules. Maybe I've done a really good job consolidating into a single cloud fund distribution onto a single WAF we back. But if now you have one WFle that does something that it shouldn't, all of a sudden the entire organization down. So you have to think, am I going to do it through blue-green web buckles that I'm toggling between. Or maybe I just create artificially more web apples than I need to just minimize the blast radius for my organization. Um, it's counterintuitive, but detecting actual attacks can actually be complicated. Maybe the business had a really, really successful campaign that they didn't notify you about, and you're getting a lot of requests that seems really distributed. Well, is it a genuine uh user traffic, or is it an attack? So you have to think, am I really gonna know when I'm being attacked or is it a genuine traffic. If you're using the AWS managed waffles like you should, you have to think, how do I tune them. For example, if you have an AWS W 0 10 rule to restrict a certain size, then what happens if all of a sudden one of applications needs to be able to support a threshold higher than that, say, for document uploads, for example. So you really want to be able to tune for that specific journey, for that specific application to minimize the impact. And this tuning can take time. So here is a specific example for tuning an Amazon managed rule. It took us quite a bit of time, including support from AWS. I'm not gonna go through it line by line, but you can see that the type of changes that we needed to make, ranging from application changes to The way in which we're acquiring the AWS WAF tokens, some changes even on the AWS side by the service team. Shout out to the service team. Thank you. Quite amazing agility where AWS have rolled out some enhancement across the entire state within a Sprint. So yeah, an agility that we can definitely aspire to and eventually it was time well spent because we were able to achieve the business accepted level of false positive. So um. Don't be, uh, don't be scared away from it. Uh, it was, uh, ultimately, it allowed us to create a cookie cutter report that post these two initial, um, tuning periods in those two markets. We were able to then roll it out successfully to the other 35 markets. Some challenges on the WAF side. So you really have to think, like Suri mentioned, how do you protect your own premise origin. Previously with VPC origin for the AWS origin, there used to be this restriction that now is no longer there, so we're excited to now roll it out wider. VPC origins don't no longer need to be within the same AWS account as Cloudfront. If you're adding cloud from distributions on a regular basis, you need to remember that they don't automatically enroll in the shield advanced auto mitigation. So if you're adding cloud from distribution, you need to make sure that you're um enrolling them so that they're protected. And actually uh only recently realized that uh while WAF can add. Uh, custom labels, and while there's no triggers for cloud front function on lambda edge, WA could in fact inject headers as well, which then you can do quite interesting things with within cloud front functions or lambda edge, so quite useful. We learned the hard way that at the time our logging solution was not scaling to DDoS attacks, so something that you want to be thinking about. I'm sure you have a working logging solution, but you want to make sure that it can scale up during DDoS attack. It's quite important, or else how you're going to analyze the attack and be able to add, for example, J4-based rules to mitigate it. Yes, cloudwatch logs insight is there, but for our traffic, we noticed that you can have quite a bit long running queries. It's not the cheapest service, so we, for example, exploring using AWS OpenSearch instead. Some final lesson learned. I appreciate it's like saying sell stocks high, buy them low, but what I mean by protect against tomorrow's attack, not yesterday, have you added any new infrastructure? Have you added any new applications? Do applications have new capabilities that you really want to add new waffles for them? WAF does come with API if you're not aware of the WAF automation framework, so you can mine the logs for interesting events, right? If there's any IPs, for example, that uh, introducing um any 404, any extra or large number of 500 errors, why not automatically block them, say, for 24 hour period. Know who your terms and solution architects are. We derive tremendous value from them. They can enroll you in IWS betas and various previews. Continue to invest in your SAC and your WAF team. It's not something that you're not setting WAF and forget it. It requires continuous investment. And of course the AWS SRT team is always there, but you really want to be able to independently analyze your log, mine your logs, and be able to. Uh, add, for example, J for fingerprint blocking rules, uh, yourself, and yeah, automation is absolutely key. You don't want to be there at 2 a.m. in the morning figuring out how to revert back a rule, so automation is absolutely key. In terms of what's coming up for us next is to ultimately capitalize on the investment that we've made in WAF so far, making sure that we all everything that we have done by consolidating our various endpoints and thousands upon thousands of domains onto our top level domains so that they can ultimately benefit from this very protection that we spoke about. Talk to you soon. Thanks, Dan, and I, I, I know HSBC is a big bank. A lot of the uh uh challenges they encountered are not your challenges, but learning from them and seeing that it's possible, even at their scale to basically use WAF as a layer to protect all of the applications they have, thousands and thousands of them. Is a really good practice. Now, as the day goes grows long, I tend to be more philosophical, and I want to look into the future and see what else is possible. As Dan said, we have to look ahead when it comes to AWSWAF. We can't be reactive. We have to be proactive and be faster, or at least as fast as the attackers that look to harm us, so. Practicing new rules, adding new rules, configuring, tuning, tightening the security. I, I will talk about three different things, uh, rushing through for the last few minutes. Initially we'll talk about bot control, we'll talk about layer 7 protection, and we'll talk about the general use for new rules and new custom rules and new manage rules. So when it comes to bot control, again, my company completely misunderstood what bot what bots really mean. Uh, but for bot control, you can use the managed tool that we have to first identify common bots for good and bad. So specifically allowing in search engines or SCO engines, that's an important thing that can be achieved with the common bot control or maybe blocking noisy health checkers that come from the web just because they're self-identifying, that's an easy thing you can do with common bot control. Detecting and finding the more sophisticated bots, what we call targeted bots, the bots that were built in order to specifically harm your application. This is where we typically enable targeted bot control, the next level of bot control, where we can track abnormal behaviors, not only a specific request, but looking throughout the session lifetime and see which sessions are more volumetric or they differ, they differ dramatically from normal user sessions, so we can start challenging them with a captcha, with a JavaScript challenge, or just plainly blocking them if we see that they're acting too suspiciously. And now with the age of AI and AI bots, a lot of your incoming traffic, and when I say a lot, sometimes more than 50% of your incoming traffic might be generated by AI agents. Some of them benign, some of them not so much, all of them very noisy, and you have to make sure that you are only allowing the good ones in. So by utilizing bot control, make sure that you upgrade to the latest version of bot control, version 4. You can now use web webbot off. It's a mouthful, uh, to make sure that only the allow agents, the allowed the, uh, verified agents uh are allowed into your application and all other agents probably should somehow register and verify with this, uh, uh, it's not, not yet a standard, but this is the mechanism most web, uh, providers and agent registries, uh, use to make sure that only good bots are being allowed through. When it comes to their 7 DDoS, again, this is kind of a new rule, so if you if you're not aware or are not familiar with it. Be familiar with it. There will be a QR, a QR code at the end, you can scan and learn more about it. Uh, but by enabling the essentials pack, we got this. We got this for uh included in the uh uh business pricing plan. And we can start using it. It was created with the override check enabled, so once we saw in the dashboard, there is a specific dashboard for DDoS, once we saw it causes no false positives, and it doesn't. It's a very safe rule to use. You can just check off this box and see that it only acts during DDoS attacks. It's super silent. Doing nothing during peacetime, but only when there is an actual event, it starts targeting the offensive actors be specific IP addresses or countries or AS numbers or user agents or or fingerprints, and only those will get this challenge or eventually get blocked if they if they don't behave. So make sure that you use that uh super important, very powerful tool. When, when it comes to evolving your WAF, so adding new rules, so make sure that you track your traffic. Traffic changes, right? You can, uh, maybe go viral, see more traffic. You might go viral in a bad way where attackers look out, uh, to harm you. So, make sure that you keep track of all of the traffic, not only the one that you block, only also the ones that you're, you're being allowed in, that is being allowed in. Uh, are different rules being hit? Are different rules not being hit all of a sudden? Maybe we're missing something. Maybe some attacker evolved and now we're not finding them anymore. So make sure that you track traffic all the time. On the flip side though, strike the right balance between a secure policy and a manageable policy, right? The most secure computer is locked in a safe, disconnected from the world that's not usable. So strike the right balance for you. I don't know how much time you have to invest in wealth, but it is an investment in time. So add the rules that you get the most value out of, even if it's not the perfect policy, that's good enough. The best policy is the one that you can manage. Otherwise, you'll just turn it off and do nothing with it, which is way worse. So, strike the right balance, tighten the right rules, make sure that the, the, uh, the rate-based rules that you had encountered or introduced into the policy, not only track IP addresses, but also track fingerprints, methods, labels again, uh, make, make full use of what WAF has to offer. And this is an ongoing effort. You make tighter and tighter and tighter as the attacker becomes more and more and more sophisticated. Another good practice is to maintain a staging environment. Dan mentioned it a bit. Keep track of your changes, roll them out gradually. Make sure that you, you expect what they will be doing if you're launching them into production. Uh, build your label logic in a way that allows you to, uh, test it out in your staging environments, right? If you have the luxury of it, great. In some scenarios, you can even add the same rules. To the same, oh sorry, add new rules to the same policy in count mode, even managed rules, you can add multiples of them and make sure and seeing your production traffic how they would have behaved were they in blocking mode and not in count mode. So if you don't have the capacity to run a full staging environment, at least do that. Add multiple versions of the same rule into the policy. With different actions on them, order them correctly and see what would happen if you switch a uh uh rule into block. Again, labels are your friends. And lastly, remember, AWS WAF configurations are code, right? If you look at the WAF console, there is this JSON button up there. The entire WAF configuration is just adjacent document, right? So use it, use this power, use the API that WAF provides to automate, use infrastructure as code tooling. It allows for better versioning, better, better change management. It allows for automation when it comes to new deployments. So if you have the resource to do it and with AI writing most of your automations now, it's super simple and it will save you a lot of pain. Day 100. Day 1, everything is quick and dirty. Day 100. Probably we should be doing better. So The day is done. The application is good for now. Tomorrow is a new day, obviously, and on the drive home, I'm reflecting on the lessons learned from this busy, busy day. So, we talked about architecture and cloaking your origins. We talked about a good enough initial policy. Build it however you want, manually with the pricing plan packages, with the WAF configuration protection packs, whatever, but do something day one, right? Even a policy with a single ruling count mode and logging is way better than no policy. At least you get visibility. Do the one thing you know you can manage and then grow from there. But make sure you do follow up, and do follow up quickly and repeatedly. The web is a bad place, right? So, I'm not here to scare you. I'm just here to show that WAF is an ongoing effort. And I've been doing WA for too many years now. Uh, utilizing the new pricing plans, Super predic predictable, super easy. They contain a bunch of value in them, uh, for a, for a fixed price. Make sure that your rough configurations are evolving as attackers will evolve, so make sure that you introduce new rules, upgrade your rule versions, uh, if, if they're managed rules, keep on testing, keep on viewing the logs, keep on looking for what changed uh in traffic in rule hits, what rules what what rules are being hit, what rules are being missed, right? as important. And automate and test your changes if you can, right? So it's a it's a repeated, it's repeatable, predictable, easily rolled back process. WAF configurations are code. Treat them like code. Now I promised 3 QR codes. Don't scan them. Take a picture of it. Uh, one will be a blog about the new flat rate pricing plans. It's new, so we'll learn about them. We didn't cover a lot in depth about them, but they're super useful. And these two other QR codes, uh, deal with, uh, layer 7 DOs mitigation with our new managed drool. So the one blog is a launch blog, the middle one. And the uh right hand side, your, yeah, right hand side is more of a deep dive into how to configure it and how to tune it if you need to. And with that I really appreciate your time. I know it's a, you know, busy hour, long day. Uh, some of you are still jet lagged, uh, or worse. So, uh, thank you for your time. We would really appreciate the feedback if you can leave it in the app and have a great rest of the week. Thank you all.