---
video_id: pbFLIYPsjqY
video_url: https://www.youtube.com/watch?v=pbFLIYPsjqY
is_generated: False
is_translatable: True
summary: |
  Marshall Jones and Mike Artz explain how AWS builds, applies, and shares threat intelligence at global scale, and how customers can use the same signals through native services. They frame the shared responsibility model around visibility and protections: AWS controls networks, hardware, and services, giving it massive telemetry (4.8 billion flows/sec, 34 million DNS requests/sec, 100 million API calls/sec, host process events, and deception tech such as Madpot honeypots), while customers have deep insight into their own workloads via VPC Flow Logs, Route 53 DNS logs, CloudTrail, and application or host logs. That visibility feeds a streaming and lake-based data platform that supports low-latency detections, historical investigations, and long-term summaries so analysts can derive fresh indicators despite attacker churn.
  
  They describe a “threat intel pool” refreshed by deception sensors, analyst investigations, detection outputs, and malware detonations. Each indicator is risk-assessed so AWS can safely block malicious IPs/DNS, throttle abusers at specific APIs, isolate abusive instances, or notify customers. The same pool fuels managed services (WAF, GuardDuty, Network Firewall, DNS Firewall) so customers inherit protections locally. Strategic to technical threat intel differs in shelf life, but technical IOCs (IPs, domains, TLS fingerprints, malware hashes, leaked credentials) enable immediate defenses.
  
  Three threat categories illustrate the model. For recon and probing, AWS sees broad internet scans hit its IP space; flow and TLS fingerprint analysis, combined with honeypot lures, yields blockable IPs and patterns that also power WAF managed rule groups. For credential compromise, attackers buy or steal keys, validate them via AWS APIs, and then try high-value calls like GetCallerIdentity, SES send quota, RunInstances, or creating linked accounts. AWS detects anomalous key validation across accounts, quarantines with an AWS-provided policy when safe, selectively blocks risky APIs (e.g., for S3 ransomware), and notifies affected customers. Artz notes local mitigations are limited without rotation or disablement, so timely customer action is key. For malware and DDoS, honeypots capture exploit chains, payload downloads, and C2 beacons, producing IOCs to block distribution and C2 infrastructure. Where malware bypasses deception, volumetric anomalies reveal DDoS participants; backtracking pre-attack connections uncovers C2 hosts that can be blocked, with trust-and-safety isolating abusive instances.
  
  Jones shows customer-facing controls: enabling GuardDuty to analyze flow, DNS, CloudTrail, and optional sources (S3 data events, EKS audit logs, Aurora login events, Lambda/ECS/EKS runtime) to surface findings and composite attack sequences. Operationalizing findings requires playbooks and automated responses. WAF’s Account Takeover Prevention rule group uses AWS’s stolen credential database plus request/response patterns to stop credential stuffing against custom apps. Route 53 DNS Firewall and Network Firewall block outbound C2 and malware domains early in the kill chain, with Firewall Manager simplifying org-wide deployment. GuardDuty malware protections cover runtime telemetry, S3 uploads, and AWS Backup scans; EventBridge hooks can quarantine or route clean files automatically. They close by urging customers to understand built-in AWS-wide protections, turn on and tune the managed services that expose that threat intel locally, and fill any coverage gaps before attackers adapt.
keywords: AWS threat intelligence, GuardDuty, honeypots, credential compromise, DNS firewall
---

All right, welcome everybody. Uh, those of you who have braved it out here this morning, um, welcome to protecting your infrastructure with Amazon Threat Intelligence. My name is, uh, Marshall Jones. I'm a security SA here at AWS. I focus kind of day to day on our detection and response services, our native services. Customers can operationalize and scale them, and then, you know, feeding back into how we're gonna evolve those over time. I'm here with Michael. Let him introduce himself. Hey everyone, I'm Mike Artz. I work with AWS Security as a principal security engineer, and I focused on our active defense programs, and that's really making AWS the safest place for builders transparently without you having to do anything, and we'll discuss a little bit more about that throughout this presentation. All right, so hopefully if you're here you're interested in threat intelligence, uh, if you haven't seen, I wanna make a call out that we've posted a number of different blogs on threat intelligence lately, what AWS does discovering different, uh, threat actors out there and how we, we take them down. If you have not seen that, definitely worth Googling AWS threat intelligence, uh, and seeing that, but what we wanna do in this talk is to go a little bit deeper on some of the stuff that's, that's going on behind the scenes that that Michael's team is doing, um, so. How many folks here consider themselves threat intel experts? Raise your hands. Somebody raised their hand, I'm sure. All right, well, that's good. You're gonna learn something then. All right, how many folks understand what AWS does in the threat intelligence page? Has anybody seen those blogs that I mentioned a minute ago? Alright, a couple of people. Um, and then how many folks understand how AWS threat intel goes into native AWS security services. Anyone on that one OK, you're all gonna learn a lot today then, um, so what we want to get out of this talk is learn some stuff. This is a learning conference you're gonna learn about how AWS does threat intelligence at scale, how we think about threat intelligence, how we, uh, go about collecting and, and tuning that. But then ultimately we want you to take something away from this that you can go use to improve the security at your organization so we want to focus on some of the, the ways that you can use AWBS threat intelligence in a manner that is not overwhelming using our native services, um, and, and get the most out of that to protect, you know, what's specific to your application. So with that said, what we're gonna do is Michael's gonna go through some of the AWS scale and scope and how we have, uh, are uniquely positioned to collect data and analyze these different threats that are out there. How we do this collection and then we're gonna go into some examples we're gonna, you're gonna hear us talk about global and local. So what is AWS doing for our customers as a whole just for being an AWS customer and then we're gonna focus on some of these examples and what you can do for your specific protecting your specific applications, uh, to, to even enhance that even more with some of that great threat intelligence that that we're collecting. So with that said, I'm gonna pass it over to Michael. Thanks, Mark. Excuse me. So yeah, I'd like to start in the scope aspect in, in two different pieces, the visibility that we have as AWS wide and our global visibility and what visibility you have as a customer into these different threats and the protections that we apply automatically AWS wide and the ones that you can configure and apply within your own workloads. So this wouldn't be a good security talk if we didn't show the shared responsibility model, but this also parallels our ideas of scope and protections, where AWS operates the networks, the hardware, the services, the software, and that gives us a broad global visibility into what is actually happening across the internet, where you have deep insight into your own workloads and your own risk tolerances and can configure those deeply for you. So I'll start with a statistic on that AWS scope that every day, AWS interacts with about 60% of the entire internet. Now, my definition of entire internet here is there's about 4 billion IPV4 addresses out there, and everyday AWS sees about 2.6 billion of those IP addresses with some part of AWS. So that's a massive global vantage point that we can see. And that breaks down in a couple of different ways. And this is how I kind of like to think about AWS and how it breaks down internally. Where if you didn't realize it, AWS builds on top of AWS. So it's kind of AWS all the way down. So the AWS services are built just like you would build web services. And so they comprise a class of things that operates on top of AWS with their API. We have our deception technologies, like you might have heard of our Madpot honeypots or our dark space monitoring. That are trying to elicit malicious communications and directly find those threats. We have all of the Amazon business lines and AWS business lines also operating on top of AWS, and then we have all of you, our customers, with your unique workloads also operating on top of AWS. And then out in front, we have the mediator between AWS and the rest of the world, our networking stack. And this is where we get a lot of that global visibility, that 60% of the internet everyday visibility from that networking stack. And so I wanna break down sort of each of these pieces and some of the telemetry that we're seeing at each of these places, and how we're looking for threats within those. So at that networking stack, we're looking at network flow largely. So interactions between IP to IP port information. And because as AWS we need to know who's on the other end of that IP within AWS, we also know the instance and the account that that IP maps to internally. Also in the networking layer we can see DNS. We have visibility into DNS, and that's about 34 million requests per second. I should note the network flow of 4.8 billion flows per second. It's a massive, massive incoming data set. Every second we get 4.8 billion new flows, uh, DNS at about 34 million requests per second, and that gives us insight into the domains and the resolved IPs. And you'll see how these play out in some of our threats that we're analyzing later. Uh, we have visibility into the AWS API logs, and that's at about 100 million requests per second. And that gives us insight into the HTTP layer, a slightly higher layer, sort of what APIs are being called, and specifically which we'll call out later, some of the authentication that's happening in those layers. And then Amazon and AWS operate our own host telemetry agents, so we collect telemetry from all of the hosts that are owned by Amazon. Uh, and that's at about a billion events per second. And those are things like every time a process starts or stops, we collect that information about what the process is and what it's doing. And then we get deep, deep threat intel information from our deception technologies, from our madpod honeypot, and that's about 15,000 interactions per second worldwide. And in that case, we get full content because there's no good reason to interact with a honeypot other than if you're a malicious actor, and so we do collect all of that information. And so if you are keeping track, that's about 6 billion security telemetry events per second. Now, some of those are automatically usable, like our interactions with the mad pod honey pots, like I mentioned, almost all of that is malicious, and so we can mine that immediately for all of that threat intelligence. But others, like the flow records, like the API calls are almost entirely legitimate. So in those spaces, we really need to go hunting for those threats within that massive, massive amount of data. And to do that, we're looking for patterns within those flow records, and we need a data platform that can handle it. And so I'll show the one architecture diagram that I'll show on this, and this, I'll show it for two reasons. One, this is our data platform. And we need 3 pieces of information, or 3 capabilities from our data platform. First, which is kind of that top flow, we need the ability to do a low latency and high-speed stream filtering of all that data as it's coming in to do real-time threat detection on it. And this allows this flow structures, ingests all of that information, structures and enriches it, and allows us to apply rules to it to immediately detect threats or identify patterns of behavior in real time as it's streaming. But we can't do everything as a stream, so that's where that second capability of our data platform comes in to play, and that's that next box down where we take all of those 6 billion events per second, all of that visibility, and we optimize it for query, we store it in S3 as parquet, um, and that allows us a couple of different things. That allows us to go back in time from after we see an event happen and see what happened around the time of that event, what processes we're executing around the time, what other network flows were happening around the time that we detected something. It allows us to, uh, historically look and develop new threat detections, and provide investigation capability for our investigators and our threat analysts. And then finally, because even at AWS we can't store all of that data forever. We selectively summarize it, and we keep the interesting bits from the data, but lose things like time resolution, so we'll summarize it by hour or by day, and those summaries we do keep long term for multiple years. And that allows us to go far back in time and still answer relevant security questions from our data. So that was AWS's visibility. Now, what is your visibility as a customer? Well, you have a very analogous set of visibility telemetry, uh, in the form of VPC flow logs, Route 53 DNS query logs, and cloud trail events that parallels those other Uh, those pieces that we're actually analyzing on the global scale, and you are, can absolutely control these and gather them and analyze them yourself, or you can turn on guard duty to do that for you. And as Marshall will show later, guard duty will benefit from the visibility that we gain at the AWS scale, uh, to enhance the analytics at the local scale. And you also have deep insight into your own workloads and your own application logs, your own host logs that you can collect and get deeper insights. Uh, but more importantly, you have insight into the risk tolerance in your particular business and what you can accept and can't accept for your business. So then to summarize, at the visibility, right, we have your AWS wide or your global visibility, which is this massive scale that's seeing about 60% of the internet every day. But is limited in how deep it goes. It is very surface level because we do not look at your data. We only look at the data that we need to operate our networks, to operate our hosts. So we can't see deep into the data like you can, as with your local visibility. So then on the other hand, we have, we talked about visibility and the scope of the visibility. And now we wanna look at the protections and what we can actually do. And I wanna caveat this, because we're talking about what we can do as AWS on your behalf, um, that these are capabilities that we have. We don't it's not a hammer that we wield blindly. We make sure that we do a risk analysis before we take any of these actions to make sure that they're safe to apply for all of AWS and your workloads. Because when we're operating at AWS wide scale, for example, when we're blocking IPs at the networking layer, that blocks those IPs from interacting with any part of AWS. And so we have to be both sure that it's malicious, and that, and that blocking that IP won't impact any customer workload. Another mitigation that we have when we detect abuse is we can selectively throttle at the selective AWS APIs. For example, we used this previously to help with an S3 ransomware attack where we could block the attackers using compromised credentials from being able to execute S3 ransomware techniques by blocking at the S3 API. And then in cases of abuse, our trust and safety team does have the ability to isolate abusive instances, easy to instances where we can essentially cut them off the network and say, in, in the case that they are performing a DDoS, which we'll get into later, we can isolate them and say, you're not allowed to behave on the internet anymore. And again, We take these things very seriously and make sure that it's safe to do for all customers and for your workloads. And then finally, probably our, our easiest mitigation is to actually notify you. And so we will send emails through our trust and safety and fraud departments, and you can get notifications when you enable guard duty through the same uh detections that guard duty benefits from what we're doing here. So, that was the AWS wide protections, but in your space, sort of the sky is the limit. And you can configure things like WAF, DNS firewall, and Marshall will touch on a lot of these and how how you can benefit from the visibility by configuring these yourself for your own business. So now that we've set the stage of sort of the visibility and the mitigations that we have, now we'll talk about threat intelligence specifically. And we didn't see a lot of hands up earlier, so I'll give a little short intro to threat intelligence and the different types of threat intelligence. At one end, we have your strategic threat intel, which is that high-level view, if you've ever read the the various yearly breach reports that various uh providers put out, that say, here are overall trends that we see in threats this year. Here are the overall motivations. And attack trends. And then as we get more specific, we're looking at tactical threat intel. And if you've heard of the Mitter attack matrix, this is really trying to categorize what types of things does an attacker do when they're actually executing an attack, like initial access or persistence or threat evasion, detection evasion. And these are generally termed TTPs, tactics, techniques and procedures, um, so you might hear that term again. Going even more specific, we have a whole class of operational threat intel, which is these are specific campaigns and specific actors that are executing a specific mission at the time. And this is usually very tied up with attributional. Uh, we're looking for who is doing it, as well as exactly what they're doing, what tools they're using. And then finally what we'll focus on for most of this talk is the technical threat intel, and these are the specific indicators like we know that this attacker is using that particular IP as command and control or this particular DNS domain name uh to run their uh. Their attacks. And we focus on these because these are immediately actionable. One, we can collect them with our visibility. We, we have the right visibility into them, and then we can actually take make use of them immediately by by blocking or otherwise isolating these sorts of uh IOCs. Now it's important to note that all of this threat intel has a shelf life. Attackers are advancing. All the time, as quickly as we are, it's a, it's really an arms race. And so on the strategic end, the shelf life can be months, maybe even years of these are the general trends, right? You might have heard a lot about sort of the AI trends in attacks that are that are coming out. And these sorts of things have a shelf life of months, whereas on the technical end, those specific. IPs or specific DNS domain names can have a shelf life of minutes and so they can, the attackers can rapidly cycle through their infrastructure uh to try and confuse detections and so we need to keep up with that and we need to be able to detect and respond to these things within a very short amount of time, keeping that threat intel always fresh. And so the mental model that we use at AWS that I like to think of is sort of the pool model where we have this pool of threat intelligence, which is every, all the threat intelligence from across AWS and Amazon that goes into one place and it's constantly getting refreshed by our producers. One of those producers is our deception technologies like our Madpot honey pots, our dark space monitoring, really things that are put out there to. Look vulnerable to illicit malicious behavior or look for scans that shouldn't be hitting those, but there's really nothing uh registered to those for dark space monitoring or there's no DNS name on the the Madpod fleets. So they're really just sort of hidden corners of the Internet that if you happen to stumble upon them, which botnets and malware and various threats often do when they're doing broad scale scanning, uh, we collect more information from. And so those are contributing all those technical IOCs to our threat intel. Another class of things is we have a whole bunch of human analysts that are looking primarily for that operational threat intel like tracking specific actors and campaigns. And they're also contributing the threat intel that comes out of those uh reports to our pool of threat intel. We have our threat analysis and detection folks who are analyzing all of that security telemetry and picking out those threat needles from the haystack. Also, every one of those detections that goes into there, uh, that comes out of there goes into that same threat in a pool, and this is constantly being refreshed. And all these teams are also consuming from the pool. Such that as our deception technologies improve, all of a sudden our detection technologies improve as well, because we can detect more threats, and that provides more information to our threat analysts to find new threats and track actors and campaigns. And so we don't just put everything into a pool, we also use it, like we mentioned earlier, we use that global Amazon-wide scale to perform a risk assessment and say, is this IP safe to mitigate? Is this DNS domain safe to mitigate? We put it through a very rigorous risk assessment to determine, 1, are we sure that it's malicious, and 2, is it actually safe for your workloads. And if it is, we actually place that mitigation. And this is what we do at AWS scale, to automatically protect all of AWS without you even knowing or paying for it, just by being on AWS, you get the benefit of all of this work. But not only that, that same threat intelligence goes to all of the AWS security services like WAF, guard duty, network firewall, and so you can benefit from all this work that we're doing and this global visibility locally within your own account by configuring these services. So we'll spend the rest of the talk talking about 3 different threat categories, and I'll start by talking about what we're doing as AWS and then I'll hand it off to Marshall for each of these, and he'll talk about how you can configure that the services in your own account to actually utilize this threat intelligence. So the first one I want to talk about is probably the earliest in the attacker kill chain, which is just network reconnaissance and probing, where attackers are trying to scan broad swaths of the internet to see what's out there, and is it worth going after. Now, they generally start, that generally starts by sending packets to a whole bunch of different IPs. And because Amazon owns a large number of those IPs, at some point in time, those packets are gonna come to Amazon's IP space. Now, I mentioned before that we have this networking stack that's in the middle that knows how to map an IP at any time to the instance or account that's behind it or resource that's behind it. And this is very dynamic and changes all the time, and a large number of these aren't mapped. So if those packets hit our networking stack and it's not mapped, they just get dropped. But other ones do get mapped, and some get mapped into our AWS services, some get mapped into our deception technologies, some get mapped into Amazon.com, your favorite bookstore, and some get mapped to your workloads as well and your resources. And this is just because you can, these IPs are very dynamic. You can request new IPs and change the mapping at any time. And so what we're looking for as AWS is the behavior, this sort of behavior where this one IP address is sending packets not just to a large number of IPs, but those IPs map to a large number of distinct accounts, a large number of distinct resources, a large number of distinct instances. And when we see this pattern, this is what we call traffic analysis or behavioral monitoring, we're looking, we can immediately label this as. As likely malicious as a broad scale scanner who's just out there looking for what's available on the Internet and the threat intel that we can extract from that is that scanner's IP address because that's our visibility and we can also look at what they're actually scanning for and in this case we're largely looking at those VPC flow network flow like logs, so we're looking at the, the port that they're actually scanning for. These are largely things like web ports like 80 and 443. However, there are services on other ports, and when we see broad scale scanning for other ports, that also goes into that threat intelligence pool and provides insight to our analysts to say, is there something new out that we don't know about and dig into those. Is this particular service have a new vulnerability that Hasn't been released a new zero day and we can go and further refine that and find more information about this and we do that in a number of different ways and that's how we keep that pool consuming from that pool as a global flywheel to derive more threat intelligence from this basic traffic analysis. Now, when one of those scans hits our deception technologies, it's almost immediately suspicious, because there's no good reason to interact with Madpot with our dark space. And so we can immediately classify that host as malicious and then when that host follows up with something like a probe for asking is that host vulnerable or even sending an exploit we can double down on that assurance that that is very likely a malicious host that's doing this. And collect more threat intel because Madpot gets our full content of all those interactions. We can look at things like the TLS fingerprints to identify, uniquely identify their host's uh TLS stack, the HTTP user agents and headers, and the full content of the exploit and anything that was sent down. We, we put that into our threat intel pool and do automatic mining of that data as well, and feed it back into our detections, back to our threat analysts. And then so what do we do when we see these sorts of things? Well, we block them. Again, we put them through a risk mitigation to make sure that it's safe to block. For example, we can't just block all proxy or an anonymization networks like Tor because there is valid use. Many customers use those networks to interact with their AWS resources, so we can't just blindly block them. But in those cases that pass our risk assessment, we, we can. And those scanners, when they hit our networking stack, we tell them we don't know who that IP address is and we just their packets immediately. And this provides kind of a global firewall around all of AWS that you are safer just by operating on AWS. And we see about a 73% reduction in attacks for operating on AWS versus operating outside of AWS. And we see that because we deploy our deception technologies both inside and outside of AWS and we measure the differences that we see. And we see about a 73% reduction. And at any point in time, and this is widely variable, we're blocking about 20,000 IPs that we refresh every minute as they're changing, uh, as the attackers are changing their use of those IPs. Now I'll hand it off to Marshall who will talk about how you can configure this for your workloads. Awesome. So one of the things that I wanna start with in in all the great stuff that Michael just went through is a lot of the questions that I get from customers is like, OK, you guys have all this great visibility and this threat intelligence. How do I take advantage of that? Can you give me your threat intelligence now as Michael pointed out there that is constantly being refreshed and there's a lot of sophistication behind the scenes to make sure. That uh an IP is still a malicious IP and hasn't been recycled and now it's on some legitimate, uh, you know, application so how do we give that to customers so that they can take the most advantage of that without, you know, creating false positives and creating, uh, you know, unnecessary work on the customer's behalf. So over time we have continued to feed these into our native services and I'll go through some of these examples um that's really how we see the best way to give our customers access to that threat intelligence but us still being able to help keep it refreshed and and and make sure that it's being utilized and not creating, uh, you know, undue hardships for for customers. So one of the, the first ways to help with network reconnaissance is to use uh network firewall. So if you're not too familiar with AWS network firewall, this is a stateful managed, uh, network firewall intrusion detection prevention system. With a lot of these AWS services, uh, you'll see the managed aspect of them. So for example, with network firewall, this can support hundreds of thousands of connections up to 100 gigabits per second of throughput, and you never have to manage the underlying infrastructure to take advantage of that. When it comes to the flexible rules engine, you can create your own stateful and stateless rules that are completely customizable for you as the, the customer. Then you can also take advantage of AWS managed rules and actually, as of a couple of days ago, uh, partner rules as well that you can subscribe to through AWS Marketplace and and utilize. One of the specific rules that I wanna talk about is the active threat defense rule. So this is a rule, an AWS managed rule that can help block traffic associated with malware staging URLs, botnet command and control servers, crypto mining pools, and once again this is threat intelligence that's being pulled from those deception. Technologies like Madpod and from the the work across the rest of the different threat intelligence teams at AWS that's feeding into this managed rule group that we are continually tuning and continually configuring to to so that customers can take advantage of this through network firewall, um, and this is, you know, into AWS as well as outbound, uh, which we'll talk more about kind of outbound blocking here in a little bit. We wanna jump into a couple of examples of what this would look like for a customer. So if you haven't used network firewall before, there's a number of different ways to look at logs. Uh, I just pulled some pretty, uh, basic examples of what this might look like. But if you're using this active threat defense rule group and you are looking at a log to, to see what happened, you might hone in on a few different things. So the first thing is what is the source IP that was actually communicating. Uh, communicating in this example, what was the threat associated with this. So you can see the threat name. This is a suspicious staging malware, uh, uh, IP address. We can actually see, we see the action of what happened here. So with network firewall, you can alert, you can allow, you can block, and, and this would, uh, give you that information of you know really what happened here. If you actually look above, you can see the signature that, that fired on this, uh, as well too. And then just for good measure, we also looked at the community score on virus total just to kind of uh evaluate, you know, AWS Threat intel with a uh a uh repository that a lot of folks will, uh, you know, validate uh different uh resources against to, to see if it's malicious. Uh, so as you can see, also malicious there. The next service that I wanna jump into is AWS web application firewall or AWS WAAF. So if you're not familiar, layer 7, web application firewall, so protection against, you know, DDoS, OOS top 10 different CVE, uh, vulnerability exploitation attempts against those web applications. Once again, low operational overhead. You essentially just associate it with like an API gateway, an ALB cloud front. And uh we do the scaling. It doesn't add any latency to your application. Um, and kind of scales with as, as, as high as your application traffic can go. And then there is once again a combination of the ability to create your own rules, use AWS managed rules, and also use different partner rules that you can subscribe to through the marketplace. So once again, a great place to feed this threat intel that we can give customers the ability to block more things that are specific to their application. This is not an exhaustive list of all of the, the WAF rule groups or the rule groups that you should use. We have a lot of different publications out there on, uh, example rule group ordering and some of the different things that you can do with AWS WAF. So definitely encourage you to look at that. But I wanna call out a few of them that use this threat, these threat intelligence sources that I, I think are definitely table stakes for a lot of customers. So the first one being the Amazon IP reputations list. Now the IP reputations list is what we call a rule group, and then at the bottom, the uh three different little boxes that say choose rule, action, override, those are the individual rule groups. So like managed IP reputation list, reconnaissance list, managed IPDDOS list. You have the ability to configure each one of these individual rules and say like I wanna block for this, I wanna count for this to see what would be blocked and so on and so forth. But this is how we're bringing some of that IP reputation directly into a managed rule and once again like I described a network firewall we're, you know, continually tuning behind the scenes to make sure that these, uh, these are actually malicious IPs they're still malicious and and we're blocking, you know, only malicious traffic and not legitimate traffic. The second one that I wanna call out is the anonymous IP list. So this, uh, rule group contains rules to, to block requests from services that permit obfuscation or viewer identity. So think of some of the examples that Michael gave earlier like Tor, VPNs, proxies, and then also web hosting providers. Um, so if you look at. If you look at what we might wanna block in some of these things like hey your application doesn't need to communicate with Tor so let's just take care of that, you know, right off the table. Are you running a consumer application? Do you, does somebody need to connect from like a different hosting provider? If it's a consumer application, probably not, so you, you know, blocking that, just kind of bringing that straight off the table, you're reducing a tax surface, reducing potential risk for, uh, uh, access to a potential vulnerability in an environment or something that might be tried, they might, you know, an actor might try and, uh, exploit. So anonymous IP definitely look into that. Uh, there's also great things like geo-blocking rules and things that, that folks should, should look into as well. Another one I wanna call out is the known bad inputs rule group. So this contains rules that block request patterns that are associated with the exploitation or discovery of vulnerabilities. A lot of what we talked about in the technical threat intel space so far as IPs and domains and, you know, file hashes and and malware things that we'll talk about in a little bit. But what we learn through Michael's team and and a number of the different teams is some of these like strategies that folks are using to try and exploit environments so I'm gonna use everyone's favorite uh security example of the last few years log for Jay. Well, what we saw, you know, during that time, uh, of the different techniques that people were using, uh, the different tactics that people were using, we took that information and then put it back into a WAF rule. So that folks could, uh, could block traffic associated with those types of exploit attempts. So this isn't specific to IPs or a specific domain of some actor actor campaign out there that we know is part of that. Those might have been blocked from the IP reputation list, but say for example there's a new IP that came online that just hasn't made it to that reputation list. This can give you more coverage based on the techniques that we're seeing. So although a lot of the thread intel is IPs and domains, we can also take what we've learned there and put those back into other rules like this known bad inputs rule group. If we look at an example of this, hopefully folks have seen this before, this is an AWS WAF. They have kind of built-in cloud watch log insights where you can analyze logs associated with these rule groups and these rules that are firing. If we look at this example, we can see that we have known bad input rule group, uh, actual or or different log files associated with this. If we look into one of these log files, we can see some of the information associated with what happened through this web request. One, we can see the action is that it's blocked. A lot of folks will build different dashboarding and things to understand blocks or counts, or maybe while you're operationalizing AWSY if you wanna understand, you put it in count mode and wanna understand what all is happening before I actually flip this thing over to block. But this specific example, it's blocked. We can see the HTTP request arguments, and this is if you're familiar with Lock for Jay, the JD and I look up, uh, associated with that, we can see the host that is involved here. So this is an ALB that I set up, and then, um, we can see the rule group. This is a known bad inputs rule group, and then the specific rules. So if you. Remember back the slide where we had all those rules underneath this rule group. This is the specific rule that fired the uh the one that's associated with this query string. One other thing I wanna call out for more of a detective lens in this space, uh, WAF and network firewall be preventative controls. This is inspector being a, a, a vulnerability management solution through AWS. It's a little bit different if you're not familiar than a traditional vulnerability scanner where you set it to run at like different times. This is based on a continuous method. So when you turn on inspector, it can look at different resources like EC2 instances, images and ECR, lambda functions. You can also put this into, uh, different SAS-based scanning functions as well as, uh, CICD pipelines. But the way that it works is it does like a full scan the first time and then it has an inventory of what software exists, what vulnerabilities exist on that host. There's a new vulnerability that gets introduced associated with the, you know, a package or an OS that you're using. It checks to see if that exists. If something changes on a resource, a resource changes, it, it, it does a scan, an incremental scan to see where what's changed and if any new vulnerabilities exist or old vulnerabilities don't exist anymore. So one of the places that we feed vulnerability intelligence back in here when I talk to customers about this, I probably hate to admit as often as I do about vulnerability management, but deciding on what we need to remediate and then the free or or the uh prioritization that we need to take when doing remediation. So funneling some of this threat intelligence back into inspector and understanding what's going on with vulnerabilities. If you haven't seen Inspector before, there's a vulnerability database you can see it in the left navigation pane towards the bottom. We once again stuck with this, uh, log for J example and looked that up, but if you look in that vulnerability, 1, this tells you what vulnerabilities Inspector has in its database. 2, you can see the vulnerability intelligence from AWS. What are the different targets that we're seeing associated with this? When was the last exploit seen? And then, obviously in some of these it will be a little bit different and other information that we might have with a vulnerability, but this can help customers inform. You know, have we seen a public exploit, have we not seen a public exploit? Do I need to go prioritize this now across my environment? This can definitely help on some of those prior prioritizations. So recap here for the network reconnaissance example, we on a global scale AWS has a lot of different levers for blocking different things, uh, blocking different scanners, feeding that threat intelligence pool, and as a customer this is once again not an exhaustive list, but you have a, you have a number of different things here like WAF, network firewall, using those managed rule groups, and then inspector to res reduce your overall exposure. Thanks, Marshall. So now we'll switch topics here and talk about the compromise credential threat. And just to tease why this is so important is our customer security incident response team where if you have a security incident, you can contact them and they will help you. About 2/3 of their cases deal with compromised credentials and that the initial access, the initial threat vector was the case of compromised credentials, and these credentials have two things in common generally. They're a single factor and they are long lived. For example, a username or password or a long-term AWS API key and secret key. And these days, there's almost no reason to use these long-term credentials, and AWS has a number of ways that you can get away from those and migrate to short-term credentials such as IM rules anywhere. And so if you're interested in doing that, I highly suggest migrating away from long-term credentials, especially if you're embedding them in any applications or hardware or anything that leaves your control, because those can be easily reverse engineered, and attackers can use those to to behave like rogue agents. So please come talk to us if you're, if you're interested in still using long-term credentials, long-term single factor credentials, and we can help you change. So when we say compromised credentials, really what we're meaning is leaked credentials, exposed credentials, credentials that have left your control. And for this talk we'll primarily be talking about AWS keys, uh, especially those long term keys that some people call IKEA keys because they begin with the prefix AKIA or AKA versus some of the short-term credentials like Asia keys that begin with ASIA if you were ever to look at the actual key ID. And so these can get leaked in a variety of different ways. You can accidentally commit them to public source control. They can get accidentally bundled up into your application that's deployed to a web server and available on the internet. There's unauthorized access to internal hosts that can steal these keys. In a variety of different ways, but what we're looking for with our visibility is how they're actually used by threat actors. And so we'll get back and zoom out again to sort of that global view of that AWS has across all of the globe. And look at what a threat actor does once they get one of these leaked credentials. Well, the first thing they do is try and say, is it any good? And they do that by calling an AWS API, essentially any AWS API, and they'll get an error message if that key is invalid, if it's been rotated, if it's been disabled, if it's if it's TTL has expired. But what we notice is attackers don't just do this once. They have purchased generally a large number of keys, or, or otherwise gathered a large number of credentials. So they'll try it with the 2nd 1 and say, is this valid? And then a 3rd, and then a 4th. And back to that traffic analysis or behavioral analysis, we can see this when this happens across the globe, whatever region. And we can look for this pattern of a single IP address, looking for trying to authenticate with multiple different keys, and each of these keys is associated with an account, and so it comes from different accounts. This is very anomalous behavior for standard AWS interactions. And so we can label that as malicious. That is a malicious attacker trying to validate a large number of keys. And we can get a bunch of pieces of thread intel, the IP addresses again, the TLS fingerprints. And the credentials themselves, which become very important because as we see other actors doing this, because attackers generally sell these sorts of dumps of credentials, we'll see multiple attackers using the same dumps or overlapping dumps of credentials, uh, that as soon as we see them trying to. Validate one of those credentials that has been previously compromised and put into our threat intel pool and brought back into our detections, we can immediately say you're, you're bad and everything that you have is now has now been leaked, and we can notify all the customers who have those leaked credentials. And we also see the AWS service APIs. Which takes us to the next step in the analysis that we do, is we're looking at how they're actually using these compromised credentials once they validate that they that they work. And we'll see generally the most common thing to start with that an attacker starts with is the API get caller identity, which just tells you what who owns this particular key, who owns this, what's the count behind this. But we also see them then try to do things like get send quota from simple email service to set up spam relays. We see them try to create accounts to set up corresponding payer-linked accounts, uh, that you might own, but that they that you don't know about but you're paying for to gain persistence. Or things like run instances for crypto mining or with malware pre-installed on it. And so, by analyzing these things that an attacker cares about, we get this idea of the high value AWS service APIs to an attacker, and we can tune our threat intelligence to look for specifically these things and to look for sets of these things that are anomalous, uh, because generally, there's not a lot of teams that use. Email service you either use it or you don't, and generally you don't not use it for a long time and then suddenly start using it. So looking at these anomalies in the traffic of what an attacker does helps us classify these these attackers, these service APIs. And so what do we do when we see this happen? Well, the only real mitigation against compromised credentials is to rotate or disable that credential, full stop. Everything else is just a band-aid. One of those band-aids that AWS can apply sometimes is there is a specific policy, and you can Google this, the AWS Compromise Key Quarantine Policy. And basically that's a policy that just disables a whole bunch of things that attackers generally like to do that can cause your spend to go up if they were able to do this, and, uh, and otherwise compromise your network, prevent them from doing further persistence. Um, and so in certain cases, AWS can apply this to those credentials if we're absolutely sure that that has been Uh, that, that has been leaked and is in the hands of an attacker. We can do that selective API service blocking for certain things, which is where we get to the S3 ransomware that I mentioned earlier, where we use blocking in S3 to prevent plus the presence of a compromised credential to prevent certain S3 operations from happening using that credential. But ultimately, our hammer is our customer notification. So we will notify you via email, via from our trust and safety department, from our fraud department, and if you configure guard duty, you will see the same information because it goes into that threat intel pool coming as part of a guard duty alert. We're just really happy that we haven't dropped this yet. So we're, we're looking at a local perspective or what customers can do. One of the, the top things that folks do, uh, is an enabled guard duty. So this is our threat detection and incident response service. Has a number of data sources that can be collected to look at what might be suspicious to your specific account. So the basic things are the BBC full logs, DNS logs, and cloud trail events, and we have a number of optional different data. Sources such as S3 data plan events, EKS audit logs, Aurora login events, lambda network activity, and runtime activity for ECS, Fargate, EKS, and EC2 instances so we can see actual telemetry on the host. Guard duty is widely used and protects millions of accounts. I think in Matt Garman's keynote yesterday he said something like. Some number of quadrillion events per month is monitored by guard duty so we get a lot of great telemetry here like at the service level, uh, that's, you know, specific to customers' uh environments so then we can, you know, roll into more. More threat intel directly for guard duty and to help customers from there we do this in a couple of different ways, creating findings through threat intelligence. There's also machine learning and then integrations with a number of different services so customers can respond to these findings. If we look at an example of these findings, what this is is an attack sequence finding. This, the attack sequence findings essentially bring a number of individual guard duty findings together to say this is holistically, uh, you know, the holistic picture of a security issue that you might be having. This one specific to credential compromise. If you were to get a notification from trusts and safety, obviously that's super helpful to get some of that information. Guardian can help with the more holistic picture on what all is happening here, so. This might be a little bit hard to see. I apologize, but you can see some of the different minor tactic techniques and procedures associated with this. You can see more specifics on what exactly is happening here and the resource that's involved with this. And then if you look at the different. Signals and resources. Each individual signal is like an individual guard duty finding. If you had to put the pieces of these puzzles together, you'd say, hey, there was some initial access type of finding. There was an impact type of finding, a, a discovery type of finding. Oh, these are actually all associated with the same AWS resource and they're all within the same time frame and here's the time frame. This attack sequence finding brings that information together so that you get faster to you, you can more quickly get to your response or remediation actions that you need to, to apply here. Another example I wanna talk through is back to WAF and it's the account takeover prevention rule group. So This is not specific to AWS credentials. Up until this point, uh, in this credential example we've been talking about AWS credentials. AWS WAF is, you know, layer 7 firewall that you put in front of your custom applications. This ATP rule group specifically can look for anomalous login attempts. Uh, in a login attempts from stolen credentials on a request inspection, uh, we can also look, use this to look at response on did the, the login fail? Was it successful? What is the pattern? Did it fail multiple times in a row in a rapid succession. This is us using this threat intelligence maintaining this stolen credential database so that you can protect your specific custom application. So although it's not an AWS credential compromise per se, this is still compromise credentials out there that might be specific to your application or being used to, uh, to exploit your application and just another way that you can take advantage of the threat and tell pool, uh, and, and this time not specific to AWS but specific to your application. So in this example, the, the global protections, obviously this quarantine policy, obviously notifying customers whenever we see any uh activity associated with these compromised credentials, definitely not only utilizing guard duty but like operationalizing guard duty findings is super important. So what I mean by operationalizing is. If you get a guard duty finding, what are you gonna do? Do you have a playbook? Who do you contact? What are the mitigations you're gonna put in place? How are you gonna do your investigation? Like those operationalizing aspects of the, the puzzle is super important. And then look into the ATP rule group if you're running a custom application that, uh, you know, has different user names and passwords associated with it that you want to protect. Thanks, Marshall. So the final threat that we're gonna look at is malware and we're gonna start with looking at our interactions with our deception technologies with our honey pots and recall this graph where generally folks are scanning the network looking for recon uh and then probing and exploiting but then. And, and our honeypots happily allow them to do all this and says, yes, I'm vulnerable, please exploit me, uh, please drop malware, please drop other scripts, uh, because that's what honeypots do. And so, generally the next thing that happens is, after that exploit, a piece of software Dropped to then reach out and get a more complex piece of software. Sometimes this is straight up malware, sometimes it's just the next stage in the exploit chain, and sometimes it's pseudo benign software like crypto mining software, uh, that then gets put down and configured. But because it happened in our deception technologies and because it happened after an exploit, we can immediately classify that as highly suspicious and likely malicious. And then after that payload gets downloaded, it generally reaches back out to get either command and control or exfill information, such as stolen credentials, or in the case of Bitcoin mining, connect to a Bitcoin mining pool and start trying to get the attacker some money. And so, because all of this was sourced from our deception technologies, from our honey pots, we can immediately classify all of that as malicious and collect that same information that we do. Uh, that we did previously, but also now we can get that malware binary and put it through static and dynamic analysis, actually detonate it safely within AWS to see what it does and have our analysts look at it and pick out information from about the malware distribution sites, the malware C2 sites, the IP URL, and we can block all of those and prevent all access to this sort of attacker infrastructure. But what if we, what if the attacker doesn't hit our deception technologies? That's where we fall back to those traffic analysis patterns. And we'll use an example here from DDoS malware. So with DDoS malware, there's malware, and it's usually all of a sudden it changes its, those hosts change their network pattern and all of a sudden starts sending a lot of data towards one victim host on the internet with the idea that they want that victim host to have a bad day. So usually this is a large, a large amount of bandwidth or a large number of requests. And at the networking layer, we can see this, and if you've ever worked on a networking team or looked at a bandwidth graph, this is where your graph gets very lumpy. You see massive spikes, and it's very easy to spot from a volumetric perspective, where we're just looking at how many bytes and connections are are sent between IPs. And so from this, we can identify that that person is likely having a bad day, and Uh, use that as part of our thread intel for that, that's the victim IP and use that to figure out who, who is everyone that's participating in that particular DDoS. And this is great, and we can help mitigate this after the fact, but really we wanna go back in time. We wanna prevent the DDoS from even happening. And to do that, we need to use that data platform I mentioned earlier to, to do exactly that, to look at, well, now that we've seen a DDoS, and that's very easy to detect. Who was involved in that DDoS and who did they communicate with that might have told them to perform that DDoS? So generally right before a DDoS happens, all those same instances are reaching out or being contacted by a singular host, it's command and control host or a small number of hosts. And so that's exactly what we do. We look back in time and say just before the DDoS. Who were you all contacting, and generally this is because it's a DDoS, it's distributed. There's a large number of instances in play in this, and who did they all contact, uh, at the same time right before the DDoOS happened, and that allows us to identify that malware command and control and that malware C2IP. And then we can block it, and we do this in a large case because a lot of this malware infrastructure is either fairly static or fairly unique to malware or attackers, and we can run it through those risk mitigations and determine, yes, it is safe to block. There's no legitimate use of these IPs, these DNS domain names, things like that. And so we can block those malware command and control hosts, and in some cases this completely neuters the malware and prevents it from actually working anymore. Uh, but we can also block those distribution sites that we gained from to prevent hosts from even downloading the malware. So even though the host might have been exploited, we prevent that next stage in the kill chain to prevent the, the malware from being installed. And then in the cases of hosts performing abusive behavior like Adidas, our trust and safety team can occasionally isolate those instances to wall them off from the network to prevent that future abusive behavior. And then ultimately we will notify you that you have a compromised instance and from our standpoint, we will notify you via email, but if you enable these services, you can get those, those same insights for your account with much deeper data. Alright, so we've talked about the miter attack Matrix a couple times, uh, already. If we look at this, you know, most of us are humans, we're reading from the top down. We're understanding, you know, this is probably the sequence of activities. One thing that we wanted to point out that Michael discussed a minute ago was a lot of what happens at the beginning of this kind of attack kill chain is. They get uh a basic exploit into the environment, something small, a little toehold, and then they call back out. So, what we might think of an initial access and execution. Also has to do with some of these TTPs all the way at the bottom being command and control and exfiltration. So if we can stop that outbound communication. At the beginning we can also we can potentially stop these uh attack progressions when they start before they even get like malware and a foothold in the environment. So one of the best ways to do this is with Route 53 DNS firewall. This works with the, the dot-2 or the DNS resolver that's built into VPC filtering domains. This is just like those other. AWS firewall services that have a combination of custom rule group or custom rules that you can create as well as Amazon manage rules. It integrates with firewall manager that we haven't talked about yet but that essentially can help you deploy this out across your organization very easily. If we look at an example of DNS firewall findings, you might see something, uh, you know, pretty simple on an EC2 instance where you curl some domain, and if we look at the corresponding log associated with this, we can see the query that happened there and then the firewall rule action that happened associated with that interaction but once again just stopping that outbound domain commun DNS communication kind of at the start. And mitigating that attack progression early on. Jumping back to Amazon guard duty that we talked about earlier, the threat detection capabilities, there's a number, I didn't, I didn't point this out earlier, but there's a number of different malware capabilities associated with guard duty. So with our runtime monitoring we can see things on the host. A couple days ago we launched AWS guard duty malware. Protection for AWS backup so you can look for malware associated with the backups of EC2 and S3. We also have malware protection for S3, which is often used for untrusted uploads before customers move files to like a different point in their application. So those are different ways to take care of this malware. If we look at this example, this is from runtime monitoring. If we see, if you, you know, touch at the type there, you can see execution, runtime, malicious file executed. That's, this is essentially the guard duty finding type. If we look at some more of this information, we can see the name of the process that was running the executable path, the Shaw 256 hash gives us a lot more information there. And then we can also see the threat list. So this, this threat intelligence, the, the. Identified this malware came from an AWS threat intelligence source in guard duty. We actually use, uh, uh, a few different threat intelligence sources, a couple different partner sources along with the Amazon threat intelligence, uh, but once again how we're identifying these, uh, this malware. We look at one more guard duty example, we can see this one is associated with an object upload to S3. This is just a basic ICAR test file, so Michael and his team don't get mad at me and my personal account, um. But this is we we can see this malicious upload. We also have hooks into things like event bridge so you can do like event driven architectures of hey this was a malicious file move this to a quarantine bucket or this was a, a clean file, you know, move this onto my application and, and, and keep rolling. So protection from malware, blocking malware related IPs and isolating instances that Michael and his team, uh, you know, accomplished across AWS if at the customer specific level, guard duty is another great thing here. I didn't touch on this, but network firewall is also a, a, a, a key piece of blocking traffic in and out associated with malware related traffic, and then obviously DNS firewall once again, uh, an AWS managed service that scales with your application, so there's no, there's no latency involved there. So to wrap up Just a couple of call to actions. It's important to understand AWS Threat and tell what are we doing to protect all of our customers? What are the protections that you get just by being an AWS customer? And this could be some kid who is learning AWS in his dorm all the way up to, you know, a Fortune 50 customer, uh, and everyone in between. Second, how can I utilize these individual services to make sure I'm utilizing AWS threat intelligence to the best of my abilities? Understanding where you have them, where you have gaps, working backwards from what controls or what security challenges you have today, and understanding where you can benefit from some of those services, uh, is gonna be greatly important to your overall security posture. So with that, I wanna say thank you. Please fill out the survey as I'm obligated to say, uh, and we'll hang out outside if people wanna ask questions and, and discuss anything else, um, related to Threat intel or anything else. So thank you all.
